"use strict";function _classCallCheck(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,i){for(var a=0;a<i.length;a++){var t=i[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function _createClass(e,i,a){return i&&_defineProperties(e.prototype,i),a&&_defineProperties(e,a),e}!function(n){var e=function(){function i(e){_classCallCheck(this,i),this.inizialized=!1,this.container=e.container,this.openers=e.openers,this.loader=e.loader?e.loader:"header>.linear-spinner",this.closeButtons=void 0===e.closeButtons?".close-element button":e.closeButtons}return _createClass(i,[{key:"init",value:function(){if(!this.inizialized){var i=this;this.$container=n(this.container),this.$container.length<1||(n(document).on("webForm-ready webForm-resize webForm-form-change",function(e){i.webFormChange(e)}),this.$container.css({display:"none"}),this.$iframe=this.$container.find("iframe[data-src]"),0<this.$iframe.length&&(this.$iframe.on("show-iframe",function(e){i.$container.hasClass("shown")?(i.hideIframe(e),setTimeout(function(){i.loadIframe(e)},1050)):i.loadIframe(e)}),this.$iframe.on("hide-iframe",function(e){i.hideIframe(e)}),this.$openers=n(this.openers),this.$openers.on("click",function(e){i.loadIframe(e)})),this.inizialized=!0)}}},{key:"loadIframe",value:function(e){var i=this;n(this.loader).addClass("active");var a=this;this.$iframe.one("load",function(){a.showIframe(e),n(document).trigger("loaded-iframe",a.$iframe),n(i.loader).removeClass("active")}),this.$container.css({display:"block"}),this.$iframe.html("").attr("src",""),this.$iframe.attr("src",this.$iframe.data("src")),n(document).trigger("loading-iframe",this.$iframe)}},{key:"showIframe",value:function(e){var i=n(e.currentTarget);this.$backTarget=i.parents("section").first();var a=n(this.container);if(!a.hasClass("shown")){var t=this,s=document.querySelector(".iframe-wrapper.shown");s&&(s.classList.replace("shown","hidden"),s.style.display="none"),a.find(this.closeButtons).one("click",function(e){t.hideIframe(e)});var r=a.find(">.wrapper");a.css({display:"block"}).removeClass("hidden").addClass("shown");var o=r.outerHeight();a.css({height:o}),setTimeout(function(){a.hasClass("sto-3d")?(t.$container.hasClass("sto-3d")&&1024<t.$container.outerWidth()&&n("body>.dialog-off-canvas-main-canvas").css({overflow:"unset"}),setTimeout(function(){window.scrollTo(0,window.outerHeight),document.dispatchEvent(new CustomEvent("webform-iframe-loaded",{detail:{size:{height:0,width:0}}}))},500)):t.scrollTo(a)},500)}}},{key:"hideIframe",value:function(e){var i=this,a=n(this.container);a.css({height:0}),a.hasClass("sto-3d")&&n("body>.dialog-off-canvas-main-canvas").css({overflow:"hidden"}),n(document).trigger("hiding-iframe",this.$iframe);var t=this;setTimeout(function(){a.css({height:0}),a.removeClass("shown").addClass("hidden").css({display:"none"}),t.$backTarget.hasClass("iframe-wrapper")||t.scrollTo(t.$backTarget),n(document).trigger("hidden-iframe",i.$iframe)},1e3)}},{key:"webFormChange",value:function(e){var i=this.$iframe,a=e.detail.size.height;i.css({height:a});var t=i.parents(".iframe-wrapper").first();if(t.hasClass("shown")){var s=t.find(">.wrapper");console.log("wrapper height:",s.outerHeight()),t.css({height:s.outerHeight()})}}},{key:"scrollTo",value:function(e){var i=e.offset().top-n("header").outerHeight();window.smooth?window.smooth.scrollTo(i):n(window).scrollTop(i)}}]),i}();window.IframeLoader=window.IframeLoader?window.IframeLoader:e}(jQuery);